# 网站前端-游戏系统

[TOC]

## games.vue

| 参数 | 值                     |
| ---- | ---------------------- |
| 地址 | `/games`               |
| 用途 | 查看所有已经部署的游戏 |
| 权限 | 登录用户               |
| 预览 | ![](imgs\games.PNG)    |

| 属性  | 解释                                                                     |
| ----- | ------------------------------------------------------------------------ |
| games | 所有游戏，使用 asyncData 获取                                            |
| modal | 之前设计时点击游戏详情会弹出弹窗，数据来自于 modal，但是这个功能被屏蔽了 |

| 函数       | 参数 | 返回值 | 解释                                                                       |
| ---------- | ---- | ------ | -------------------------------------------------------------------------- |
| readDetail | game | null   | 之前设计时点击游戏详情会弹出弹窗，调用这个函数用来控制弹窗，该功能被屏蔽了 |

## game/\_id.vue

| 参数 | 值                                  |
| ---- | ----------------------------------- |
| 地址 | `/game/<game id>`                   |
| 用途 | 查看编号为 game id 的游戏的详细信息 |
| 权限 | 登录用户                            |
| 预览 | ![](imgs\game_id.PNG)               |

| 属性 | 解释                                                  |
| ---- | ----------------------------------------------------- |
| id   | 当前选项卡的编号                                      |
| game | 该游戏详情页面对应的游戏的数据，使用 asyncData 获取值 |

| 函数             | 参数 | 返回值 | 解释                                                                     |
| ---------------- | ---- | ------ | ------------------------------------------------------------------------ |
| isActive/select  | id   | null   | 用于维护当前的选项卡是哪个选项卡                                         |
| download_file    | url  | null   | 点击下载游戏包按钮时调用该函数，向服务器请求游戏包文件                   |
| isManager        | null | null   | 当前用户是否为当前游戏的管理员，具有修改权限                             |
| introductionHTML | null | null   | 将 markdown 格式的 introduction 转化为 html 格式，在网页上进行富文本显示 |

| 依赖部件   | 传入部件参数           |
| ---------- | ---------------------- |
| match-list | 游戏编号               |
| ai-list    | 游戏编号，允许远程算力 |

## game/\_slug/edit.vue

| 参数 | 值                                  |
| ---- | ----------------------------------- |
| 地址 | `/game/<game id>/edit`              |
| 用途 | 修改编号为 game id 的游戏的详细信息 |
| 权限 | 超级管理员                          |
| 预览 | ![](imgs\game_id_edit.PNG)          |

| 属性      | 解释                                            |
| --------- | ----------------------------------------------- |
| form      | 修改游戏详情提交的表单，使用 asyncData 获取初值 |
| isLoading | 正在提交表单到服务器                            |
| isOK      | 服务器返回提交表单成功信息                      |
| err_code  | 提交表单失败时，设置为响应的 status code        |
| game      | 当前选中游戏的详细信息，使用 asyncData 获取值   |

| 函数        | 参数 | 返回值 | 解释                                 |
| ----------- | ---- | ------ | ------------------------------------ |
| saveInfo    | null | null   | 将修改后的游戏详情表单提交到服务器上 |
| upload_game | null | null   | 选中游戏包并将游戏包上传到服务器上   |

## game/\_slug/ranklist.vue

| 参数 | 值                                  |
| ---- | ----------------------------------- |
| 地址 | `/game/<game id>/ranklist`          |
| 用途 | 查看编号为 game id 游戏绑定的排行榜 |
| 权限 | 登录用户                            |
| 预览 | ![](imgs\game_id_ranklist.PNG)      |

| 属性    | 解释                                                        |
| ------- | ----------------------------------------------------------- |
| game    | 当前排行榜对应游戏的信息，使用 asyncData 获取               |
| players | 排行榜中每个玩家的信息，包括得分，username，AI 分支和版本号 |

| 函数 | 参数 | 返回值 | 解释 |
| ---- | ---- | ------ | ---- |
|      |      |        |      |

## match/\_id.vue

| 参数 | 值                                                           |
| ---- | ------------------------------------------------------------ |
| 地址 | `/match/<match id>`                                          |
| 用途 | 查看对局编号为 match id 的对局详情，如果有 HTML 播放器则回放 |
| 权限 | 登录用户                                                     |
| 预览 | ![](imgs\match_id.PNG)                                       |

| 属性              | 解释                                                       |
| ----------------- | ---------------------------------------------------------- |
| iframe            | 存储网页播放器的一些参数，例如是否全屏，网页播放器地址等等 |
| match             | 存储的是当前游戏的玩家、游戏等信息，用 asyncData 获取      |
| player_controller | 存储的是控制播放器的一些参数，例如播放速度、当前帧等等     |

| 函数                | 参数  | 返回值 | 解释                                         |
| ------------------- | ----- | ------ | -------------------------------------------- |
| download_replay     | id    | null   | 用于生成一个下载链接，使用户能够下载回放文件 |
| onLoad              | null  | null   | 在播放器加载好后初始化播放器                 |
| postMessage         | data  | null   | 向播放器发送指令和数据                       |
| receiveMessage      | event | null   | 从播放器收到信息并进行处理                   |
| playerLoadFrame     | null  | null   | 让播放器载入控制器的当前帧                   |
| playerLoadNextFrame | null  | null   | 让播放器载入控制器的下一帧                   |
| previousFrame       | null  | null   | 控制器载入前一帧                             |
| nextFrame           | null  | null   | 控制器载入后一帧                             |
| playNextFrame       | null  | null   | 控制器播放下一帧(播放将是连续的)             |
| changeSpeed         | null  | null   | 将控制器播放速度设置成下一档                 |
| resetPlayer         | null  | null   | 重置控制器到初始帧                           |
